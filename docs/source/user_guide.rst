==========
User guide
==========

.. toctree::
   :maxdepth: 2


This guide is intended for end users of the MyTardis Sequencing Facility app
- those sharing and downloading data produced by a facility.


What MyTardis-Seq provides
--------------------------
MyTardis-Seq is a permanent archive of your sequencing data (the FASTQ files, plus more).
It allows you to securely share and download the results of sequencing runs, as well as view
summaries of associated QC reports and basic metadata associated with the run
(FastQC reports, instrument models, read lengths, processing software versions,
etc).


Quickstart
----------

*I'm a busy bioinfomatician dammit, just give me my data !*

Assuming you:

* are comfortable with the commandline
* know your MyTardis-Seq login details (username/password)
* know how to use SFTP

Here's the quickstart:

* Log in to your facilities MyTardis-Seq site at
  `https://<mytardis_seq_url>/login` (eg https://mhtp-seq.erc.monash.edu.au/login).
* Go to `https://<mytardis_seq_url>/sftp_access`
  (eg https://mhtp-seq.erc.monash.edu.au/sftp_access)
* Follow the instructions to login via SFTP, find your data and download it as
  a `tar.gz` archive.


Logging in
----------
By default, all data in MyTardis-Seq is private so you'll need to login to see
your data. If the Facility Manager has assigned you are username/password
(a 'local' Django account), you can login using these. Depending on the MyTardis
configuration you may also be able to login using your institutional
username/password (eg LDAP or Monash authcate username / password).
Ask your Facility Manager for details on the login options available.

.. image:: images/login_button.png
   :width: 700px


Navigating MyTardis-Seq pages
-----------------------------

The front page of MyTardis lists your recent sequencing projects.

.. image:: images/mydata_list_screenshot.png
   :width: 700px

Clicking the "Sequencing Project, .., .." link brings you to the Project Experiment page,
with an overview of your Datasets in that sequencing run.

.. image:: images/experiment_screenshot.png
   :width: 700px

Clicking a "FASTQ reads, .., .." links brings you to the FASTQ dataset summary page.
This page includes an overview of the FastQC reports for each sample/file which can be
revealed by clicking the "Show" button.

.. image:: images/fastq_dataset_screenshot.png
   :width: 700px

MyTardis allows download of FASTQ file in the browser, however this method often
isn't preferred for large nucleotide short read datasets which are usually
transferred to a server for assembly/alignment and other downstream analysis.

Instead, data can be download via the commandline using `direct download via SFTP`_
or `direct download via HTTPS`_ using an obfuscated link.


Data organization: Project Experiments and Datasets
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
MyTardis organizes data as Experiments, Datasets and Datafiles. MyTardis-Seq uses
this structure to organize sequencing runs into Experiments and uses Datasets beneath
these Experiments to cleanly seperate 'raw' (FASTQ) data from derived data
(eg FastQC reports).

Your data from one sequencing run is stored as an `Experiment`, named something
like **"Sequencing Project, YourName, 29-Feb-2015"**. In MyTardis-Seq we call these
`Project Experiments`. Inside the `Project Experiment` are several `Datasets` -
one for the FASTQ reads (named **"FASTQ reads, YourName, 29-Feb-2015"**) and one
for the generated FastQC reports. There may be additional Datasets inside the
Project Experiment if additional processing or reporting has been generated by
the facility.

Inside each `Dataset` are the individual files (`Datafiles`) - for example the
FASTQ reads `Dataset` contains the `*.fastq.gz` files.


Direct download via SFTP
------------------------

Experiments are accessible via SFTP (eg using the ``sftp`` commandline tool or
software like `CyberDuck <https://cyberduck.io/>`_).

Click the SFTP button on the Project Experiment page to see instructions on how
to download your data via SFTP (note that there is no SFTP button on FASTQ dataset pages).

.. image:: images/sftp_login_button.png
   :width: 700px

Direct download via HTTPS
-------------------------

Experiments can also be downloaded directly using ``wget`` or ``curl`` using an
obfusicated link.

From an Experiment page, select the Sharing tab and then click the "Create
New Temporary Link" button. The links to the Experiment page and a direct download
link to a ``tar`` archive are provided.

.. image:: images/sftp_login_button.png
   :width: 700px

By default temporary links expire after a month. You can manually delete
them within the web interface once you data begins downloading. Avoid using
temporary links for sensitive datasets - use SFTP instead.
